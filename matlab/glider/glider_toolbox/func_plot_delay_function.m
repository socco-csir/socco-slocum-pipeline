function [] = func_plot_delay_function(params)
% function [] = func_plot_delay_function(params)
% 
% GEOMAR SVN $Id: func_plot_delay_function.m 303 2017-03-06 08:52:37Z gkrahmann@geomar.de $
%
% plot the sensor response to a 1 degree step function for different 
% flow_speeds
%
% input  :   params         []         - 4-element vector of parameters defining the sensor response
%                                        If no parameters are given, example responses from GEOMAR
%                                        gliders are shown.
%
% version 2.1.0  last change 25.01.2023

% G.Krahmann, GEOMAR, Sep 2012

% updated the list of optimized parameters                  GK, 06.03.2017  1-->2
% changed function call names                               GK, 25.01.2023  2-->2.1.0

%
% here's a list of optimized parameter vectors for GEOMAR gliders
%
param_ref = [0.0455936    0.0633617      19.3695  8.60867e-13;...
  0.01     0.102023  3.55715e-13      14.2636;...
  0.01    0.0752926      17.5031      6.75022;...
  0.0131011    0.0952341  3.59757e-12      15.4382;...
  0.01     0.106376      3.12476      11.8036;...
  0.01     0.115038  1.15463e-14      12.1914;...
  0.0483549    0.0492368      8.43508      11.9425;...
  0.01    0.0880583      6.52381      11.4846;...
  0.0313233    0.0708787      14.5182      4.82322;...
  0.0262427     0.078371      19.8325  3.03135e-12;...
  0.01    0.0954588       5.2391      12.4905;...
  0.0529137    0.0584581  4.73903e-11      16.2539;...
  0.0842949     0.033071      13.6405       8.3095;...
  0.01    0.0933615  5.22249e-13      15.8787;...
  0.0100016     0.081473      16.5389      3.76971;...
  0.01     0.13767      8.7712      5.0139;...
  0.2         0.05  5.55556e-13      10.1517;...
  0.0824851         0.05  4.05675e-13      17.6765;...
  0.129124   0.00920971  5.04041e-14      19.0898;...
  0.0711358         0.05  1.10361e-11      18.2701;...
  0.0747636    0.0410122         2.15      14.9784;...
  0.0745937    0.0348456  1.11526e-11       18.138;...
  0.01     0.112188  1.49925e-12      13.2071;...
  0.0304037    0.0585437      18.5823  0.000631704;...
  0.01    0.0732954  4.16778e-13      20.7929;...
  0.01    0.0697009   2.0377e-12      20.7125;...
  0.135605  2.41976e-13      21.7906  2.95364e-12;...
  0.12726  5.52336e-16      1.74197      17.5907;...
  0.01    0.0820434      2.95772      15.8553;...
  0.0323389    0.0654408   9.4813e-14      12.1413;...
  .01      0.06966      23.8127      1.11789;...
  0.2         0.05      24.7688            5;...
  .114061  4.46865e-16      21.7464      3.69285;...
  0.0539252    0.0338394       21.048  1.22569e-13;...
  0.01     0.112166  7.26086e-14      16.5502;...
  0.01     0.125284  1.19948e-12      12.9984;...
  0.01         0.15  1.15463e-14       13.114;...
  0.01     0.100032  1.12666e-10      14.9717;...
  0.0547364     0.102123  4.50084e-13      12.9712;...
  0.01    0.0846449      14.2178       6.0325];

[dummy,ind] = sort(param_ref(:,1));
param_ref = param_ref(ind,:);




data.ctd_temperature = [ones(1,100),zeros(1,100)];
data.depth = 0*data.ctd_temperature;
data.datenum = [1:length(data.ctd_temperature)]/86400;

rgb = [linspace(1,0,length(param_ref))',linspace(0,1,length(param_ref))',linspace(0,0,...
        length(param_ref))'];


%
% plot the delay function for different flow speeds
%
clf
count2 = 1;
for fs = [0.15,0.25,0.5,1.00]
  count = 1;
  for nnn=1:size(param_ref,1)

    subplot(2,2,count2)

    param1 = param_ref(nnn,:);

    data.flow_speed = 0*data.ctd_temperature+fs;
    data.ctd_temperature_in_cell = ...
      func_correct_thermal_lag_garau(data.datenum,data.ctd_temperature,data.flow_speed,param1);

    plot(data.ctd_temperature_in_cell,'color',rgb(count,:))
    hold on
    count = count+1;
  end

  if nargin>0
    data.flow_speed = 0*data.ctd_temperature+fs;
    data.ctd_temperature_in_cell = ...
      func_correct_thermal_lag_garau(data.datenum,data.ctd_temperature,data.flow_speed,params);

    plot(data.ctd_temperature_in_cell,'k','linewidth',2)
  end

  xlabel('time [sec]')
  ylabel('temperature [^oC]')

  count2 = count2+1;
  grid on
  title(['Conductivity cell flow speed : ',num2str(fs),' m/s'])
end
